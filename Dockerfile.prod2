# FROM dunglas/frankenphp
FROM composer:latest AS composer

WORKDIR /app

COPY . /app
RUN composer install --no-dev --no-interaction --no-progress --no-suggest

FROM php:8.3-cli-alpine

RUN set -ex \
  && apk --no-cache add \
    postgresql-dev

RUN docker-php-ext-install \
    pcntl \
    pdo \
    pdo_pgsql

COPY --from=composer /app /app
WORKDIR /app

ENTRYPOINT ["php", "artisan", "octane:frankenphp"]
